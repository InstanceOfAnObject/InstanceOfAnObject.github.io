<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Include Javascript And CSS On Your MasterPage</title>
  <meta name="description" content="This is a quick one.On the web I see a lot of tricks on how to do this but in fact it’s quite easy.The ProblemWhen you reference a script or a css file on yo...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://www.instanceofanobject.com/blog/2012/06/14/include-javascript-and-css-on-your-masterpage.html">
  <link rel="alternate" type="application/rss+xml" title="Instance Of An Object" href="http://www.instanceofanobject.com/feed.xml" />

  <link rel="stylesheet" href="/assets/images/autreplanete_icons/social_icons/CSS_sprite/css/apico-sprites.css" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">
      <img src="/assets/images/logo/logo-horizontal.png" alt="Instance Of An Object" />  
    </a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <a class="page-link " href="/">Home</a>
        <a class="page-link selected" href="/blog">Blog</a>
        <a class="page-link " href="/projects">Projects</a>
        <a class="page-link " href="/about">About</a>
        
          
          <!-- <a class="page-link" href="/404.html">Page not found</a> -->
          
        
          
          <!-- <a class="page-link" href="/about/">About</a> -->
          
        
          
          <!-- <a class="page-link" href="/blog/">Blog</a> -->
          
        
          
        
          
        
          
        
          
          <!-- <a class="page-link" href="/projects/">Projects</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/tools/index.html">Posts Tagged &ldquo;tools&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/c%23/index.html">Posts Tagged &ldquo;c#&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/logging/index.html">Posts Tagged &ldquo;logging&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/log4net/index.html">Posts Tagged &ldquo;log4net&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/nlog/index.html">Posts Tagged &ldquo;nlog&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/sql%20server/index.html">Posts Tagged &ldquo;sql server&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/hardware/index.html">Posts Tagged &ldquo;hardware&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/technology/index.html">Posts Tagged &ldquo;technology&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/browsers/index.html">Posts Tagged &ldquo;browsers&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/chrome/index.html">Posts Tagged &ldquo;chrome&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/windows/index.html">Posts Tagged &ldquo;windows&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/software/index.html">Posts Tagged &ldquo;software&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/css/index.html">Posts Tagged &ldquo;css&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/web%20development/index.html">Posts Tagged &ldquo;web development&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/database/index.html">Posts Tagged &ldquo;database&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/mono%20project/index.html">Posts Tagged &ldquo;mono project&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/android/index.html">Posts Tagged &ldquo;android&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/.net/index.html">Posts Tagged &ldquo;.net&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/entity%20framework/index.html">Posts Tagged &ldquo;entity framework&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/jquery/index.html">Posts Tagged &ldquo;jquery&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/jquery-ui/index.html">Posts Tagged &ldquo;jquery-ui&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/asp.net/index.html">Posts Tagged &ldquo;asp.net&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/javascript/index.html">Posts Tagged &ldquo;javascript&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/json/index.html">Posts Tagged &ldquo;json&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/jqgrid/index.html">Posts Tagged &ldquo;jqgrid&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/t-sql/index.html">Posts Tagged &ldquo;t-sql&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/ajax/index.html">Posts Tagged &ldquo;ajax&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/visual%20studio/index.html">Posts Tagged &ldquo;visual studio&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/tfs/index.html">Posts Tagged &ldquo;tfs&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/macros/index.html">Posts Tagged &ldquo;macros&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/routing/index.html">Posts Tagged &ldquo;routing&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/patterns/index.html">Posts Tagged &ldquo;patterns&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/forms%20authentication/index.html">Posts Tagged &ldquo;forms authentication&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/network/index.html">Posts Tagged &ldquo;network&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/ssrs/index.html">Posts Tagged &ldquo;ssrs&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/reporting/index.html">Posts Tagged &ldquo;reporting&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/jekyll/index.html">Posts Tagged &ldquo;jekyll&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/security/index.html">Posts Tagged &ldquo;security&rdquo;</a> -->
          
        
          
          <!-- <a class="page-link" href="/tag/google/index.html">Posts Tagged &ldquo;google&rdquo;</a> -->
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Include Javascript And CSS On Your MasterPage</h1>
    <div class="post-meta">
    	Jun 14, 2012

	    <ul class="tag_list">
	      
	      <li class="inline archive_list"><a class="tag_list_link" href="/tag/web development">web development</a></li>
	      
	      <li class="inline archive_list"><a class="tag_list_link" href="/tag/asp.net">asp.net</a></li>
	      
	      <li class="inline archive_list"><a class="tag_list_link" href="/tag/javascript">javascript</a></li>
	      
	      <li class="inline archive_list"><a class="tag_list_link" href="/tag/css">css</a></li>
	      
	    </ul>
    </div>

  </header>

  <article class="post-content">
    <p>This is a quick one.</p>

<p>On the web I see a lot of tricks on how to do this but in fact it’s quite easy.</p>

<h2 id="the-problem">The Problem</h2>

<p>When you reference a script or a css file on your masterpage it takes the relative path of that file according to the MasterPage location. The problem is that the MasterPage isn’t the one that it’s going to be shown, it will be the actual ASPX page the inherits from it.<br />
This said, if your ASPX files are in other location than the MasterPage then the references script files path won’t be resolved.</p>

<p>There’s also the problem when your site can either run on a virtual folder or as a site on IIS.</p>

<h2 id="the-solution">The Solution</h2>

<p>There are a lot of ways to handle this, but most rely on specific ASPX locations.<br />
I like to have my ASPXs well organized on a convenient way, sometimes in the same folder but most of the times on separated folders.<br />
I don’t want to be forced to put all pages on the same folder just because of this.</p>

<p>So the idea is to put all the script and CSS references on the MasterPage <em>&lt;head&gt;</em>, make use of the server-side tilde (~) and write the correct paths on Page_Init.</p>

<p>If you need to reference jquery and jqueryUI your MasterPage <em>&lt;head&gt;</em> should look similar as the following:</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;head</span> <span class="na">runat=</span><span class="s">&quot;server&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;&lt;/title&gt;</span>

 <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;&lt;%# ResolveUrl(&quot;</span><span class="err">~/&quot;)</span> <span class="err">%</span><span class="nt">&gt;</span>css/custom-theme/jquery-ui-1.8.21.custom.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;

 <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;&lt;%# ResolveUrl(&quot;</span><span class="err">~/&quot;)</span> <span class="err">%</span><span class="nt">&gt;</span><span class="nx">Scripts</span><span class="o">/</span><span class="nx">jquery</span><span class="o">-</span><span class="mf">1.7</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="nx">min</span><span class="p">.</span><span class="nx">js</span><span class="s2">&quot; type=&quot;</span><span class="nx">text</span><span class="o">/</span><span class="nx">javascript</span><span class="err">&quot;</span><span class="o">&gt;</span><span class="nt">&lt;/script&gt;</span>
 <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;&lt;%# ResolveUrl(&quot;</span><span class="err">~/&quot;)</span> <span class="err">%</span><span class="nt">&gt;</span><span class="nx">Scripts</span><span class="o">/</span><span class="nx">jquery</span><span class="o">-</span><span class="nx">ui</span><span class="o">-</span><span class="mf">1.8</span><span class="p">.</span><span class="mi">20</span><span class="p">.</span><span class="nx">min</span><span class="p">.</span><span class="nx">js</span><span class="s2">&quot; type=&quot;</span><span class="nx">text</span><span class="o">/</span><span class="nx">javascript</span><span class="err">&quot;</span><span class="o">&gt;</span><span class="nt">&lt;/script&gt;</span>

    <span class="nt">&lt;asp:ContentPlaceHolder</span> <span class="na">ID=</span><span class="s">&quot;head&quot;</span> <span class="na">runat=</span><span class="s">&quot;server&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/asp:ContentPlaceHolder&gt;</span>
<span class="nt">&lt;/head&gt;</span></code></pre></div>

<p>Now, on the MasterPage CodeBehind you should include the following code:</p>

<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnLoad</span><span class="p">(</span><span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">base</span><span class="p">.</span><span class="n">OnLoad</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
 <span class="n">Page</span><span class="p">.</span><span class="n">Header</span><span class="p">.</span><span class="n">DataBind</span><span class="p">();</span>
<span class="p">}</span></code></pre></div>

<p>DONE!</p>

<p><strong>Keep in mind that the script and css references paths must be relative to he root of your site.</strong></p>

<p>This way, everywhere the MasterPage is used the paths to the resources will always be correct.</p>

<p>Cheers!</p>

  </article>

  <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'instanceofanobject';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Instance Of An Object</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Instance Of An Object</li>
          <li><a href="mailto:mail@alexcode.com">mail@alexcode.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/InstanceOfAnObject">
              <span class="apico-color apico-github"></span>GitHub
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/alexcode">
              <span class="apico-color apico-twitter"></span>Twitter
            </a>
          </li>
          
        </ul>
      </div>

      <!-- <div class="footer-col  footer-col-3">
        <p class="text">Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
</p>
      </div> -->
    </div>

  </div>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68037427-1', 'auto');
  ga('send', 'pageview');
</script>

</footer>


  </body>

</html>
